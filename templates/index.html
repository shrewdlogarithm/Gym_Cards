<head>
  {% include 'head.j2' %}
  <script src="webcam.js"></script>
  <script>
  if (!!window.EventSource) {
    var source = new EventSource('/stream');
    source.onmessage = function(e) {
      if (!e.data.startsWith("##")) {
        $("#video").hide()
        $("#photo").hide()
        vals = e.data.split(":::")
        if (vals[0] == "Welcome!") {
          $("#ads").show()
          $("#centerbox").html("")
        } else {
          $("#ads").hide()
          $("#centerbox").removeClass().addClass(vals[1]).html(vals[0])
        }
        
      }
      if (e.data.startsWith("##ShowCap")) {
        $("#photo").hide()
        $("#video").show()
      }
      if (e.data.startsWith("##MakeCap")) {
        takepicture(e.data.substring(9))
      }
      if (e.data.startsWith("##MemImg")) {
        $("#video").hide()
        $("#photo").attr("src","images/" + e.data.substring(8) + ".png?" + Math.random()).show()
      }
      if (e.data == "##Refresh") {
        location.reload()
      }
    }
  }
  </script>
</head>
<body>
    {% include 'toplayout.j2' %}
    <div id="centerbox"></div>  
    {% include 'bottomlayout.j2' %}
</body>
